<UserControl x:Class="VDLaser.Views.Controls.SerialPortSettingView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:vm="clr-namespace:VDLaser.ViewModels.Controls;assembly=VDLaser.ViewModels"
             xmlns:local="clr-namespace:VDLaser.Converters"
             mc:Ignorable="d" 
             x:Name="RootView">
    <UserControl.Resources>
        <local:BrushColorConverter x:Key="BrushColorConverter"/>
    </UserControl.Resources>
    <UserControl.DataContext>
        <Binding Path="DataContext.SerialPortSettingVM"
             RelativeSource="{RelativeSource AncestorType=Window}" />
    </UserControl.DataContext>
    <GroupBox Header="Port settings" Style="{StaticResource GroupBoxStyleVD}">
        <StackPanel>
            <!-- Parameters of the serial port. Only COM port and Baud rate are available -->
            <Grid Margin="5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="3*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Label Content="Port COM" HorizontalAlignment="Left" VerticalAlignment="Center" VerticalContentAlignment="Center"/>
                <ComboBox Grid.Column="1" ItemsSource="{Binding ListPortNames}" SelectedItem="{Binding PortName,Mode=TwoWay}"
                              HorizontalAlignment="Center" Width="75" VerticalContentAlignment="Center" Margin="0" 
                              VerticalAlignment="Center" IsEnabled="{Binding DataContext.CanEditSerialSettings,
           RelativeSource={RelativeSource AncestorType=Window}}"/>
                <Label Grid.Row="1" Content="Baud rate" HorizontalAlignment="Left" Margin="0" VerticalAlignment="Center" 
                           VerticalContentAlignment="Center"/>
                <ComboBox Grid.Row="1" Grid.Column="1" Width="75" Margin="0" ItemsSource="{Binding ListBaudRates}"
                              VerticalAlignment="Center" SelectedItem="{Binding BaudRate, Mode=TwoWay}"
                              VerticalContentAlignment="Center" IsEnabled="{Binding DataContext.CanEditSerialSettings,
           RelativeSource={RelativeSource AncestorType=Window}}"/>
                <Ellipse Grid.Column="2" Grid.Row="0" Height="20" Margin="0,0,0,0" Stroke="#FFABADB3" 
                         VerticalAlignment="Center" Width="20" Fill="{Binding DataContext.IsConnected,
       RelativeSource={RelativeSource AncestorType=Window},
       Converter={StaticResource BrushColorConverter}}"/>
                <Button x:Name="RefreshButton" Grid.Column="2" Grid.Row="1" HorizontalAlignment="Center" Margin="5,0,5,0"
        VerticalAlignment="Center" HorizontalContentAlignment="Center" 
        Command="{Binding RefreshPortsCommand}"
        IsEnabled="{Binding DataContext.CanEditSerialSettings,
            RelativeSource={RelativeSource AncestorType=Window}}"
        ToolTip="Refresh Port COM">
                    <StackPanel Height="20" Width="20" >
                        <Image Source="/Resources/Assets/iconRefresh40.png"/>
                    </StackPanel>
                </Button>
            </Grid>
            <!--Buttons to connect/disconnect and refresh port COM-->
            <Grid Margin="5" Width="Auto">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Button x:Name="ConnectButton" Content="Connect" HorizontalAlignment="Center"
                        VerticalAlignment="Center" Command="{Binding DataContext.ConnectCommand, 
                                  RelativeSource={RelativeSource AncestorType=Window}}"
                        Width="75" HorizontalContentAlignment="Center" Margin="0"/>
                <Button x:Name="DisconnectButton" Grid.Column="2" Content="Disconnect" HorizontalAlignment="Center"
                        VerticalAlignment="Center" Width="75" HorizontalContentAlignment="Center" Margin="0" Command="{Binding DataContext.DisconnectCommand, 
                        RelativeSource={RelativeSource AncestorType=Window}}"/>
            </Grid>
        </StackPanel>
    </GroupBox>
</UserControl>
